import{s as Q,u as R,n as X,B as q,m as u}from"./poke-B8mls0Pg.js";import{s as G,a as I}from"./index-D0tO1LNR.js";import{d as A,f as J,h as T,o as i,w as c,a as D,b as o,U as E,u as e,e as m,t as d,i as K,N as O,r as f,V as L,W as Y,c as v,D as $,F as B,g as Z,Q as ee}from"./index-ChqMJAs5.js";import{s as te}from"./index-DSEynn-R.js";import{s as N}from"./index-BXZi-p6s.js";import{s as x}from"./index-BXbjibp7.js";const ae=["src","alt"],se={name:"SplitterPanel"},b=A({...se,props:{sprite:{},name:{},hp:{},maxHp:{},enemy:{type:Boolean}},setup(C){const s=C,k=J(()=>Math.floor(s.hp/s.maxHp*100));return(t,y)=>(i(),T(e(G),{style:E(t.enemy?"text-align: right":"")},{default:c(()=>[D("img",{src:t.sprite,alt:t.name,style:E(t.enemy?"":"transform: scaleX(-1)"),onLoad:y[0]||(y[0]=p=>t.$emit("sprite"))},null,44,ae),o(e(Q),{value:k.value},{default:c(()=>[m("HP: "+d(t.hp)+" ("+d(k.value)+"%)",1)]),_:1},8,["value"])]),_:1},8,["style"]))}}),ne={key:0},le={key:1,style:{display:"flex","justify-content":"space-around"}},ie={key:2},fe=A({__name:"PokeBattle",setup(C){const s=R(),k=K(),t=O(),y=f(0),p=f({}),M=f(0),H=f(!1),_=L([]),g=f(!0);let a;const P=f(!1),V=f(!1),w=L([]);let S;function j(){y.value=s.hp}function F(){M.value=p.value.stats.hp}async function h(n){return P.value=!0,new Promise(l=>{S=setTimeout(()=>{n(),P.value=!1,l(1)},1e3)})}function z(){V.value=!0;const n=w[0];S=setTimeout(async()=>{a.ailment.skip>0?await h(()=>{a.ailment.skip--,t.add({detail:"턴 생략 적용⏰",life:2e3})}):(w.push(...w.splice(0,1)),n.select(y)),g.value=!0,u.ailment.neutralize>0&&u.ailment.neutralize--,u.ailment.dot.length&&await h(()=>{u.ailment.dot[0](),t.add({detail:"지속 피해 적용🔥",life:2e3}),u.ailment.dot.shift()}),u.ailment.skip>0&&(await h(()=>{u.ailment.skip--,t.add({detail:"턴 생략 적용⏰",life:2e3})}),g.value=!1,a.ailment.dot.length&&await h(()=>{a.ailment.dot[0](),t.add({detail:"지속 피해 적용🔥",life:2e3}),a.ailment.dot.shift()}),z())},1e3)}async function U(n){n.select(M),n.used=!0,_.map(r=>r.used).every(r=>r)&&_.forEach(r=>r.used=!1),g.value=!1,a.ailment.neutralize>0&&a.ailment.neutralize--,a.ailment.dot.length&&await h(()=>{a.ailment.dot[0](),t.add({detail:"지속 피해 적용🔥",life:2e3}),a.ailment.dot.shift()}),z()}return k.load("getPokelist").setWhenSuccess(async n=>{await X(n.results[Math.floor(Math.random()*n.results.length)].url,p.value),a=new q(p.value,()=>s.level,t),_.push(...u.getMoveList(a)),w.push(...a.getMoveList(u)),H.value=!0}).fire(),Y(()=>clearTimeout(S)),(n,r)=>(i(),v("main",null,[o(e(N),null,{title:c(()=>[m(d(e(s).name)+" ",1),o(e(te),{style:{display:"inline-block"}},{default:c(()=>r[0]||(r[0]=[m("VS")])),_:1,__:[0]}),m(" "+d(p.value.ko+" Lv "+e(s).level),1)]),content:c(()=>[H.value?(i(),T(e(I),{key:0},{default:c(()=>[o(b,{sprite:e(s).sprite,name:e(s).name,hp:y.value,"max-hp":e(s).hp,onSprite:j},null,8,["sprite","name","hp","max-hp"]),o(b,{sprite:p.value.sprites,name:p.value.ko,hp:M.value,"max-hp":p.value.stats.hp,enemy:"",onSprite:F},null,8,["sprite","name","hp","max-hp"])]),_:1})):$("",!0)]),_:1}),o(e(x)),o(e(N),null,{content:c(()=>[P.value?(i(),v("span",ne,"지속 피해 계산중..")):g.value?(i(),v("div",le,[(i(!0),v(B,null,Z(_,(l,W)=>(i(),T(e(ee),{key:W,variant:"outlined",disabled:l.used,onClick:oe=>U(l)},{default:c(()=>[D("div",null,[m(d(l.ko)+" ",1),o(e(x)),m(" "+d(l.category)+" ",1),l.category.includes("damage")?(i(),v(B,{key:0},[o(e(x)),m(" 예상 데미지: "+d(l.expectDamage),1)],64)):$("",!0),l.expectEffect?(i(),v(B,{key:1},[o(e(x)),m(" 효과: "+d(l.expectEffect),1)],64)):$("",!0)])]),_:2},1032,["disabled","onClick"]))),128))])):V.value?(i(),v("span",ie,"Action 선택중..")):$("",!0)]),_:1})]))}});export{fe as default};
